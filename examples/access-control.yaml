---
name: Request without header is denied
vcl: examples/access-control.vcl

request:
  url: /api/test

backend:
  status: 200
  body: "backend response"

expect:
  status: 403
  backend_calls: 0

---
name: Request with header is allowed
vcl: examples/access-control.vcl

request:
  url: /api/test
  headers:
    X-Letmein: "On"

backend:
  status: 200
  body: "backend response"

expect:
  status: 200
  body_contains: "backend response"
  backend_calls: 1
